description: >
  This command takes a valid pipeline schedule json file.
  This command checks for existing schedules based on the schedule name.
  If the schedule does not exist in the specified project, a new one will be created.
  If the schedule does exist, it will be updated based on the supplied json schedule.

parameters:
  circle-token:
    type: env_var_name
    default: CIRCLE_TOKEN
    description: >
      The personal API Token associated with the project.
  project-name:
    type: string
    description: >
      The name of project associated with the pipeline.
  vcs-type:
    type: enum
    enum: ["gh", "bb"]
    default: "gh"
    description: >
      The VCS type for the project. GitHub and BitBucket are currently supported with GitHub being the default value.
  namespace:
    type: string
    description: >
      The username or organization name in the specified version control system.
  schedule-path:
    type: string
    description: >
      The location of the json pipeline schedule to be created or updated (relative or absolute).
      The json structure of the schedule can be found here: https://circleci.com/docs/scheduled-pipelines/
steps:
  - run:
      environment:
        ORB_EVAL_PROJECT_NAME: << parameters.project-name >>
        ORB_EVAL_SCHEDULE_JSON_PATH: << parameters.schedule-path >>
        ORB_VAL_VCS_TYPE: << parameters.vcs-type >>
        ORB_VAL_NAMESPACE: << parameters.namespace >>
      name: Create and Update Schedule
      command: <<include(scripts/create-and-update-schedule.sh)>>
